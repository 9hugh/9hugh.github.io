{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hugh's 的乌托邦",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/09/05/%E5%B7%A5%E4%BD%9C%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/",
            "url": "http://example.com/2023/09/05/%E5%B7%A5%E4%BD%9C%E9%A1%B9%E7%9B%AE%E6%96%87%E6%A1%A3/",
            "title": "",
            "date_published": "2023-09-05T02:43:28.988Z",
            "content_html": "<h1 id=\"离职对接项目文档\"><a class=\"markdownIt-Anchor\" href=\"#离职对接项目文档\">#</a> 离职对接项目文档</h1>\n<h2 id=\"七月主要项目\"><a class=\"markdownIt-Anchor\" href=\"#七月主要项目\">#</a> 七月主要项目：</h2>\n<h3 id=\"一-对hada-pool客户端solo模式以及管理端下的业务进行分析\"><a class=\"markdownIt-Anchor\" href=\"#一-对hada-pool客户端solo模式以及管理端下的业务进行分析\">#</a> 一、对 HADA POOL 客户端 SOLO 模式以及管理端下的业务进行分析</h3>\n<h4 id=\"1solo模式-子账户列表k\"><a class=\"markdownIt-Anchor\" href=\"#1solo模式-子账户列表k\">#</a> 1.SOLO 模式 - 子账户列表 k</h4>\n<p>a.SOLO 账户对应币种的钱包地址以及 icon</p>\n<p><img data-src=\"../../public/assets/image-20230905102736455.png\" alt=\"image-20230905102736455\"></p>\n<p>b. 设备状态、收益以及算力统计部分</p>\n<p><img data-src=\"../../public/assets/image-20230905103158047.png\" alt=\"image-20230905103158047\"></p>\n<p>c.Reward (奖励) 有关趋势图以及日志数据</p>\n<p><img data-src=\"../../public/assets/image-20230905103322268.png\" alt=\"image-20230905103322268\"></p>\n<p><img data-src=\"../../public/assets/image-20230905103355533.png\" alt=\"image-20230905103355533\"></p>\n<h4 id=\"2solo模式-设备明细\"><a class=\"markdownIt-Anchor\" href=\"#2solo模式-设备明细\">#</a> 2.SOLO 模式 - 设备明细</h4>\n<p>a. 设备的在线状态以及对应算力信息和显卡信息</p>\n<p><img data-src=\"../../public/assets/image-20230905103504137.png\" alt=\"image-20230905103504137\"></p>\n<p>b. 设备在线统计表</p>\n<p><img data-src=\"../../public/assets/image-20230905103549951.png\" alt=\"image-20230905103549951\"></p>\n<h4 id=\"二-使用go语言实现调用api获取指定货币的ratio服务费率220版本从system_config表中获取230版本改为从currency_info_expand表中获取\"><a class=\"markdownIt-Anchor\" href=\"#二-使用go语言实现调用api获取指定货币的ratio服务费率220版本从system_config表中获取230版本改为从currency_info_expand表中获取\">#</a> 二、使用 Go 语言实现调用 api 获取指定货币的 Ratio 服务费率【2.2.0 版本从 system_config 表中获取，2.3.0 版本改为从 currency_info_expand 表中获取】</h4>\n<figure class=\"highlight markdown\"><figcaption data-lang=\"markdown\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>func getRatio(keyType, sysKey string) float64 &#123;</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    BaseUrl := \"http://localhost:8080/pc/v1/sys/config\"</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    client := http.Client&#123;&#125;</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    req, err := http.NewRequest(\"GET\", BaseUrl, nil)</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    if err != nil &#123;</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>       fmt.Println(\"get failed, err:\", err)</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>       return 1</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    query := req.URL.Query()</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    query.Add(\"keyType\", keyType)</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    query.Add(\"sysKey\", sysKey)</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    req.URL.RawQuery = query.Encode()</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>​    resp, err := client.Do(req)</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>​    // 检查响应状态码</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>​    if resp.StatusCode != http.<span class=\"token italic\"><span class=\"token punctuation\">*</span><span class=\"token content\">StatusOK</span><span class=\"token punctuation\">*</span></span> &#123;</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>​       fmt.Println(\"请求返回状态码错误:\", resp.StatusCode)</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>​       return 1</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>​    &#125; else &#123;</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>​       defer resp.Body.Close()</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>​       body, err := io.ReadAll(resp.Body) // 读取返回出的内容,返回的是byte</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>​       if err != nil &#123;</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>​          fmt.Println(\"读取响应值失败！\", err)</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>​          return 1</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>​       &#125;</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>​       fmt.Println(string(body))</pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>​       // 解析JSON响应体</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>​       var responseData ResponseData</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>​       err = json.Unmarshal(body, &amp;responseData)</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>​       if err != nil &#123;</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>​          fmt.Println(\"JSON解析失败:\", err)</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>​          return 1</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>​       &#125;</pre></td></tr><tr><td data-num=\"37\"></td><td><pre>​       // 提取特定的值</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>​       dataValue := responseData.Data</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>​       fmt.Println(\"提取的data值:\", dataValue)</pre></td></tr><tr><td data-num=\"40\"></td><td><pre>​       Fee, err := strconv.ParseFloat(dataValue, 64)</pre></td></tr><tr><td data-num=\"41\"></td><td><pre>​       return Fee</pre></td></tr><tr><td data-num=\"42\"></td><td><pre>​    &#125;</pre></td></tr></table></figure><h2 id=\"八月主要项目\"><a class=\"markdownIt-Anchor\" href=\"#八月主要项目\">#</a> 八月主要项目：</h2>\n<h3 id=\"image-20230905101447200\"><a class=\"markdownIt-Anchor\" href=\"#image-20230905101447200\">#</a> <img data-src=\"../../public/assets/image-20230905101447200.png\" alt=\"image-20230905101447200\"></h3>\n<h3 id=\"一-收益首页列表功能包括币种收益总览以及子账户收益总览\"><a class=\"markdownIt-Anchor\" href=\"#一-收益首页列表功能包括币种收益总览以及子账户收益总览\">#</a> 一、收益首页列表功能【包括币种收益总览以及子账户收益总览】</h3>\n<p><img data-src=\"../../public/assets/image-20230905104652550.png\" alt=\"image-20230905104652550\"></p>\n<p><img data-src=\"../../public/assets/image-20230905104725662.png\" alt=\"image-20230905104725662\"></p>\n<h4 id=\"1币种收益总览币种排序\"><a class=\"markdownIt-Anchor\" href=\"#1币种收益总览币种排序\">#</a> 1. 币种收益总览 + 币种排序</h4>\n<p>a. 使用多线程异步获取各个币种的收益总览信息</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 获取登录用户的 id</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">long</span> loginCustomerId <span class=\"token operator\">=</span> <span class=\"token class-name\">LoginHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLoginCustomerId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 获取用户币种的排序方式</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencySortVo</span><span class=\"token punctuation\">></span></span> listOfSort <span class=\"token operator\">=</span> customerCurrencySortService<span class=\"token punctuation\">.</span><span class=\"token function\">showSortCurrency</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 创建一个 List 用来保存三种不同币种的收益</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeUserOverviewResponseVo</span><span class=\"token punctuation\">></span></span> userIncomeList <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">// 获取所有币种收益的 Future</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CompletableFuture</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeUserOverviewResponseVo</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> futures <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencySortVo</span> currencySort <span class=\"token operator\">:</span> listOfSort<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token class-name\">CompletableFuture</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeUserOverviewResponseVo</span><span class=\"token punctuation\">></span></span> currencyFuture <span class=\"token operator\">=</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token punctuation\">.</span><span class=\"token function\">supplyAsync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">CurrencyEnum</span> currency <span class=\"token operator\">=</span> <span class=\"token class-name\">CurrencyEnum</span><span class=\"token punctuation\">.</span><span class=\"token function\">getByCode</span><span class=\"token punctuation\">(</span>currencySort<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> poolShareSettlementDayQueryService<span class=\"token punctuation\">.</span><span class=\"token function\">queryUserIncomeByCurrency</span><span class=\"token punctuation\">(</span>loginCustomerId<span class=\"token punctuation\">,</span> currency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    futures<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>currencyFuture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">// 用于保存各币种收益的 Map 集合</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">IncomeUserOverviewResponseVo</span><span class=\"token punctuation\">></span></span> incomeMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token class-name\">CompletableFuture</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Void</span><span class=\"token punctuation\">></span></span> allFutures <span class=\"token operator\">=</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token punctuation\">.</span><span class=\"token function\">allOf</span><span class=\"token punctuation\">(</span>futures<span class=\"token punctuation\">.</span><span class=\"token function\">toArray</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CompletableFuture</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>allFutures<span class=\"token punctuation\">.</span><span class=\"token function\">thenRun</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CompletableFuture</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeUserOverviewResponseVo</span><span class=\"token punctuation\">></span></span> future <span class=\"token operator\">:</span> futures<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        <span class=\"token class-name\">IncomeUserOverviewResponseVo</span> currencyIncome <span class=\"token operator\">=</span> future<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        incomeMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>currencyIncome<span class=\"token punctuation\">.</span><span class=\"token function\">getChainTypeName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> currencyIncome<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>allFutures<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>b. 根据获取的子账户排序规则对获取的收益进行排序处理【这里并加入了零值隐藏的过滤条件】</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 将三种币种的收益汇总</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>listOfSort<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">// 如果用户没有排序规则，则按默认排序</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 逐一获取</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IncomeUserOverviewResponseVo</span> income <span class=\"token operator\">:</span> incomeMap<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">BigDecimal</span> totalIncomes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>income<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">BigDecimal</span> forecastIncomes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>income<span class=\"token punctuation\">.</span><span class=\"token function\">getForecastIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 判断是否需要隐藏无收益的币种</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>totalIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ZERO</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> forecastIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ZERO</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> isHiddenZero<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        userIncomeList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>income<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token comment\">// 按顺序取值放入结果集中</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencySortVo</span> sortType <span class=\"token operator\">:</span> listOfSort<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token class-name\">String</span> chainType <span class=\"token operator\">=</span> <span class=\"token class-name\">CurrencyEnum</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChainTypeNameByCode</span><span class=\"token punctuation\">(</span>sortType<span class=\"token punctuation\">.</span><span class=\"token function\">getType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token class-name\">IncomeUserOverviewResponseVo</span> currencyIncome <span class=\"token operator\">=</span> incomeMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>chainType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token class-name\">BigDecimal</span> totalIncomes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>currencyIncome<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token class-name\">BigDecimal</span> forecastIncomes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>currencyIncome<span class=\"token punctuation\">.</span><span class=\"token function\">getForecastIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token comment\">// 判断是否需要隐藏无收益的币种</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>totalIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ZERO</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> forecastIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">compareTo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ZERO</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> isHiddenZero<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        userIncomeList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>currencyIncome<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"2子账户收益总览子账户排序\"><a class=\"markdownIt-Anchor\" href=\"#2子账户收益总览子账户排序\">#</a> 2. 子账户收益总览 + 子账户排序</h4>\n<p>a. 根据传入的币种查询该币种下各个子账户的收益情况【具体业务层获取逻辑自行查看】</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">subAccountOverview</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"chainType\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">String</span> chainType<span class=\"token punctuation\">,</span> <span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"isHiddenZero\"</span><span class=\"token punctuation\">,</span> required <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">boolean</span> isHiddenZero<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">CurrencyEnum</span> currency <span class=\"token operator\">=</span> <span class=\"token class-name\">CurrencyEnum</span><span class=\"token punctuation\">.</span><span class=\"token function\">getByName</span><span class=\"token punctuation\">(</span>chainType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 创建一个 List 用于保存排序好的子账户收益</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token punctuation\">></span></span> subOverview <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 获取子账户的排序规则【注意这里查到的是所有子账户的一个排序】</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BusinessSubAccountSortVo</span><span class=\"token punctuation\">></span></span> sortInfo <span class=\"token operator\">=</span> customerBusinessSubAccountSortService<span class=\"token punctuation\">.</span><span class=\"token function\">showCustomerSubAccountSortInfo</span><span class=\"token punctuation\">(</span>currency<span class=\"token punctuation\">.</span><span class=\"token function\">getCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 获取子账户信息</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">List</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> listWebResult <span class=\"token operator\">=</span> poolShareSettlementDayQueryService<span class=\"token punctuation\">.</span><span class=\"token function\">querySubAccountIncomeByCurrency</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LoginHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLoginCustomerId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> currency<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token punctuation\">></span></span> data <span class=\"token operator\">=</span> listWebResult<span class=\"token punctuation\">.</span><span class=\"token function\">getData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>b. 对查询到的子账户列表加上排序规则以及零值过滤</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 将子账户收益信息放入 Map 集合中以 子账户 id 为键，IncomeSubOverviewResponseVo 为 Value</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Long</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token punctuation\">></span></span> dataMap <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">toMap</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IncomeSubOverviewResponseVo</span><span class=\"token operator\">::</span><span class=\"token function\">getSubCustomerId</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span><span class=\"token function\">identity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 去除判断</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">BusinessSubAccountSortVo</span> sortType <span class=\"token operator\">:</span> sortInfo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">IncomeSubOverviewResponseVo</span> incomeSubOverviewResponseVo <span class=\"token operator\">=</span> dataMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>sortType<span class=\"token punctuation\">.</span><span class=\"token function\">getSubAccountId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 获取累计收益和今日预估收益</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">String</span> totalIncomes <span class=\"token operator\">=</span> incomeSubOverviewResponseVo<span class=\"token punctuation\">.</span><span class=\"token function\">getTotalIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token class-name\">String</span> forecastIncomes <span class=\"token operator\">=</span> incomeSubOverviewResponseVo<span class=\"token punctuation\">.</span><span class=\"token function\">getForecastIncomes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>totalIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> forecastIncomes<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> isHiddenZero<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    subOverview<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>incomeSubOverviewResponseVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>subOverview<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"二-币种设置管理端\"><a class=\"markdownIt-Anchor\" href=\"#二-币种设置管理端\">#</a> 二、币种设置【管理端】</h3>\n<p><img data-src=\"../../public/assets/image-20230905110406679.png\" alt=\"image-20230905110406679\"></p>\n<p><img data-src=\"../../public/assets/image-20230905110423778.png\" alt=\"image-20230905110423778\"></p>\n<h4 id=\"1币种扩展信息显示支持更新时间的过滤\"><a class=\"markdownIt-Anchor\" href=\"#1币种扩展信息显示支持更新时间的过滤\">#</a> 1. 币种扩展信息显示【支持更新时间的过滤】</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiOperation</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"获取币种扩展列表信息\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"2.3.0 已完成\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/currencyExpand/list\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageVo</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencyInfoExpandVo</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">pageCurrencyInfoExpand</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">CurrencyInfoExpandRequestVo</span> requestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> currencyInfoExpandService<span class=\"token punctuation\">.</span><span class=\"token function\">pageInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LoginHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLoginAdminId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">PageVo</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencyInfoExpandVo</span><span class=\"token punctuation\">></span></span> pageVos <span class=\"token operator\">=</span> dozerUtil<span class=\"token punctuation\">.</span><span class=\"token function\">pageVoList</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> <span class=\"token class-name\">CurrencyInfoExpandVo</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            target<span class=\"token punctuation\">.</span><span class=\"token function\">setChainTypeName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyEnum</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChainTypeNameByCode</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            target<span class=\"token punctuation\">.</span><span class=\"token function\">setCurrencyType</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            target<span class=\"token punctuation\">.</span><span class=\"token function\">setChainUnit</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyEnum</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChainUnitByCode</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            target<span class=\"token punctuation\">.</span><span class=\"token function\">setUpdatedAt</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">getUpdatedAt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">copyProperties</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>pageVos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录异常\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这里使用 DozerUtil.pageVoList ( ) 方法将 page 对象转化成 pageVo 对象</p>\n<h4 id=\"2币种费率信息的修改需要同步数据库以及本地缓存\"><a class=\"markdownIt-Anchor\" href=\"#2币种费率信息的修改需要同步数据库以及本地缓存\">#</a> 2. 币种费率信息的修改【需要同步数据库以及本地缓存】</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token class-name\">Date</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 确认币种是否存在</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token class-name\">Integer</span> currencyType <span class=\"token operator\">=</span> <span class=\"token class-name\">Integer</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>updateRequestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>currencyType <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"不存在的币种类型\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 获取需要修改的币种 type</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 获取原有数据的数据</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token punctuation\">></span></span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"currency_type\"</span><span class=\"token punctuation\">,</span> currencyType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token class-name\">CurrencyInfoExpandEntity</span> currencyInfoExpandEntity <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectOne</span><span class=\"token punctuation\">(</span>wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token class-name\">String</span> oldSettlementFee <span class=\"token operator\">=</span> currencyInfoExpandEntity<span class=\"token punctuation\">.</span><span class=\"token function\">getSettlementFee</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token class-name\">BigDecimal</span> oldRate <span class=\"token operator\">=</span> currencyInfoExpandEntity<span class=\"token punctuation\">.</span><span class=\"token function\">getRate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token class-name\">String</span> oldServiceFeeWithdraw <span class=\"token operator\">=</span> currencyInfoExpandEntity<span class=\"token punctuation\">.</span><span class=\"token function\">getServiceFeeWithdraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">// 获取需要修改的数据</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token class-name\">String</span> settlementFee <span class=\"token operator\">=</span> updateRequestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getSettlementFee</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token class-name\">BigDecimal</span> rate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>updateRequestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getRate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token class-name\">String</span> serviceFeeWithdraw <span class=\"token operator\">=</span> updateRequestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getServiceFeeWithdraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">// 只要有一个修改则触发修改操作</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>oldSettlementFee <span class=\"token operator\">!=</span> settlementFee <span class=\"token operator\">||</span> oldRate <span class=\"token operator\">!=</span> rate <span class=\"token operator\">||</span> oldServiceFeeWithdraw <span class=\"token operator\">!=</span> serviceFeeWithdraw<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\">// 修改数据库中对应信息</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token class-name\">UpdateWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token punctuation\">></span></span> updateWrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UpdateWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    updateWrapper<span class=\"token punctuation\">.</span><span class=\"token function\">lambda</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getSettlementFee</span><span class=\"token punctuation\">,</span> settlementFee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getRate</span><span class=\"token punctuation\">,</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getServiceFeeWithdraw</span><span class=\"token punctuation\">,</span> serviceFeeWithdraw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getUpdatedAt</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CurrencyInfoExpandEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getCurrencyType</span><span class=\"token punctuation\">,</span> currencyType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> updateWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token comment\">// 同步更新本地缓存信息</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token class-name\">CurrencyInfoEntity</span> currencyInfo <span class=\"token operator\">=</span> localCache<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyTypeMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>currencyType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token class-name\">CurrencyInfoExpandEntity</span> currencyExpand <span class=\"token operator\">=</span> currencyInfo<span class=\"token punctuation\">.</span><span class=\"token function\">getCurrencyInfoExpandEntity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    currencyExpand<span class=\"token punctuation\">.</span><span class=\"token function\">setSettlementFee</span><span class=\"token punctuation\">(</span>settlementFee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    currencyExpand<span class=\"token punctuation\">.</span><span class=\"token function\">setRate</span><span class=\"token punctuation\">(</span>rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    currencyExpand<span class=\"token punctuation\">.</span><span class=\"token function\">setServiceFeeWithdraw</span><span class=\"token punctuation\">(</span>serviceFeeWithdraw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"3币种费率信息的迁移从system_config表中迁移至currency_info_expand表中\"><a class=\"markdownIt-Anchor\" href=\"#3币种费率信息的迁移从system_config表中迁移至currency_info_expand表中\">#</a> 3. 币种费率信息的迁移【从 system_config 表中迁移至 currency_info_expand 表中】</h4>\n<p><strong>注意：有关费率信息的方法都修改为从 currency_info_expand 表中获取</strong></p>\n<h3 id=\"三-显卡配置管理端\"><a class=\"markdownIt-Anchor\" href=\"#三-显卡配置管理端\">#</a> 三、显卡配置【管理端】</h3>\n<p><img data-src=\"../../public/assets/image-20230905135330997.png\" alt=\"image-20230905135330997\"></p>\n<p><img data-src=\"../../public/assets/image-20230905135406280.png\" alt=\"image-20230905135406280\"></p>\n<h4 id=\"1显卡基本显卡信息列表显示加入读取型号显示型号模板类型的过滤条件进行查询\"><a class=\"markdownIt-Anchor\" href=\"#1显卡基本显卡信息列表显示加入读取型号显示型号模板类型的过滤条件进行查询\">#</a> 1. 显卡基本显卡信息列表显示【加入读取型号，显示型号，模板类型的过滤条件进行查询】</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiOperation</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"显卡配置-显卡信息显示\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"2.3.0 已完成\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/gpuConfig/list\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PageVo</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigVo</span><span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span> <span class=\"token function\">pageGpuBasicConfig</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">MachineGpuBasicConfigRequestVo</span> requestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">LoginHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLoginAdminId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> result <span class=\"token operator\">=</span> machineGpuBasicConfigService<span class=\"token punctuation\">.</span><span class=\"token function\">pageInfo</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">PageVo</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigVo</span><span class=\"token punctuation\">></span></span> pageVos <span class=\"token operator\">=</span> dozerUtil<span class=\"token punctuation\">.</span><span class=\"token function\">pageVoList</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> <span class=\"token class-name\">MachineGpuBasicConfigVo</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            target<span class=\"token punctuation\">.</span><span class=\"token function\">setOverclockingFlag</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已配置\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">getOverclockingFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                target<span class=\"token punctuation\">.</span><span class=\"token function\">setOverclockingFlag</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"暂无\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token class-name\">BeanUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">copyProperties</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span>pageVos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录异常\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">pageInfo</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigRequestVo</span> requestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> page <span class=\"token operator\">=</span> <span class=\"token class-name\">PageHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getPageSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">lambda</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">hasText</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuType</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">.</span><span class=\"token function\">like</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuReadModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuReadModel</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuReadModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token punctuation\">.</span><span class=\"token function\">like</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectPage</span><span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">,</span> wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"2编辑显卡gpu超频模板只要修改一个数据就执行更新操作\"><a class=\"markdownIt-Anchor\" href=\"#2编辑显卡gpu超频模板只要修改一个数据就执行更新操作\">#</a> 2. 编辑显卡 gpu 超频模板【只要修改一个数据就执行更新操作】</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@ApiOperation</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"显卡配置-编辑超频模板\"</span><span class=\"token punctuation\">,</span> notes <span class=\"token operator\">=</span> <span class=\"token string\">\"2.3.0 已完成\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/gpuConfig/editTemplates\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NoneResponseVO</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">editOverClockingTemplates</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">GpuBasicConfigUpdateRequestVo</span> requestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">return</span> machineGpuBasicConfigService<span class=\"token punctuation\">.</span><span class=\"token function\">editOverClockingTemplates</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LoginHelper</span><span class=\"token punctuation\">.</span><span class=\"token function\">getLoginAdminId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>requestVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">TooManyResultsException</span> manyResultsException<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"创建失败,唯一性约束异常\"</span><span class=\"token punctuation\">,</span> manyResultsException<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"创建失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"创建失败\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">fail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token class-name\">WebResult</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">NoneResponseVO</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">editOverClockingTemplates</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> loginAdminId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">GpuBasicConfigUpdateRequestVo</span> requestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Date</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 获取数据库原数据</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> queryWrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">QueryWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    queryWrapper<span class=\"token punctuation\">.</span><span class=\"token function\">lambda</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token class-name\">MachineGpuBasicConfigEntity</span> gpuBasicConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">selectOne</span><span class=\"token punctuation\">(</span>queryWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 如果已经存在超频模板，则查看是否更新数据</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token class-name\">UpdateWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> wrapper <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UpdateWrapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">getOverclockingFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 获取老数据</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">String</span> gpuClock <span class=\"token operator\">=</span> gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">String</span> memoryClock <span class=\"token operator\">=</span> gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token class-name\">String</span> fanSpeed <span class=\"token operator\">=</span> gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token class-name\">String</span> powerConsumption <span class=\"token operator\">=</span> gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token comment\">// 只要修改了一个就更新</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gpuClock<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                <span class=\"token operator\">!</span>memoryClock<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>                <span class=\"token operator\">!</span>fanSpeed<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                <span class=\"token operator\">!</span>powerConsumption<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">lambda</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getTemplateName</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getTemplateName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getOverclockingFlag</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>  <span class=\"token comment\">// 编辑完成后转为已配置状态</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                    <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getUpdatedAt</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                    <span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        wrapper<span class=\"token punctuation\">.</span><span class=\"token function\">lambda</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getTemplateName</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getTemplateName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getMemoryClock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getFanSpeed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getPowerConsumption</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getOverclockingFlag</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>  <span class=\"token comment\">// 编辑完成后转为已配置状态</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getUpdatedAt</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token function\">eq</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token operator\">::</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">,</span> requestVo<span class=\"token punctuation\">.</span><span class=\"token function\">getGpuShowModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> wrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token class-name\">WebResult</span><span class=\"token punctuation\">.</span><span class=\"token function\">success</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"3同步hadaos上读取的新显卡信息数据库中machine_basic_gpu_info表添加显示型号的唯一键约束\"><a class=\"markdownIt-Anchor\" href=\"#3同步hadaos上读取的新显卡信息数据库中machine_basic_gpu_info表添加显示型号的唯一键约束\">#</a> 3. 同步 HadaOS 上读取的新显卡信息【数据库中 machine_basic_gpu_info 表添加显示型号的唯一键约束】</h4>\n<p>在插入已有显卡时，执行但是并不报错也不插入【使用 insert ignore 语句】</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token keyword\">insert</span> id<span class=\"token operator\">=</span><span class=\"token string\">\"saveNewGpuConfig\"</span> parameterType<span class=\"token operator\">=</span><span class=\"token string\">\"com.hada.pool.server.entity.MachineGpuBasicConfigEntity\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">INSERT</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">IGNORE</span> <span class=\"token keyword\">INTO</span> machine_gpu_basic_config <span class=\"token punctuation\">(</span>gpu_type<span class=\"token punctuation\">,</span> gpu_read_model<span class=\"token punctuation\">,</span> gpu_show_model<span class=\"token punctuation\">,</span> created_at <span class=\"token punctuation\">,</span> updated_at<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">VALUES</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token operator\">&lt;</span>foreach collection<span class=\"token operator\">=</span><span class=\"token string\">\"machineGpuBasicConfigs\"</span> item<span class=\"token operator\">=</span><span class=\"token string\">\"machineGpuBasicConfig\"</span> separator<span class=\"token operator\">=</span><span class=\"token string\">\",\"</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">(</span><span class=\"token comment\">#&#123;machineGpuBasicConfig.gpuType&#125;,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">#&#123;machineGpuBasicConfig.gpuReadModel&#125;,#&#123;machineGpuBasicConfig.gpuShowModel&#125;,#&#123;machineGpuBasicConfig.createdAt&#125;,#&#123;machineGpuBasicConfig.updatedAt&#125;)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>foreach<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token keyword\">insert</span><span class=\"token operator\">></span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Override</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">saveNewGpuConfig</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> gpuReadModels<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token class-name\">Date</span> now <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">></span></span> saveData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> gpuReadModel <span class=\"token operator\">:</span> gpuReadModels<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token class-name\">MachineGpuBasicConfigEntity</span> gpuBasicConfig <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MachineGpuBasicConfigEntity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// 设置基础信息</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">setGpuReadModel</span><span class=\"token punctuation\">(</span>gpuReadModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">setCreatedAt</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">setUpdatedAt</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">// 根据规则设置 显卡的显示型号</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gpuReadModel<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NVIDIA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">setGpuType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NVIDIA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            gpuReadModel <span class=\"token operator\">=</span> gpuReadModel<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NVIDIA \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>gpuReadModel<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GeForce\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                gpuReadModel <span class=\"token operator\">=</span> gpuReadModel<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"GeForce \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        gpuBasicConfig<span class=\"token punctuation\">.</span><span class=\"token function\">setGpuShowModel</span><span class=\"token punctuation\">(</span>gpuReadModel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        saveData<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>gpuBasicConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>baseMapper<span class=\"token punctuation\">.</span><span class=\"token function\">saveNewGpuConfig</span><span class=\"token punctuation\">(</span>saveData<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"九月主要项目\"><a class=\"markdownIt-Anchor\" href=\"#九月主要项目\">#</a> 九月主要项目：</h2>\n<ul>\n<li><code>├── src</code></li>\n<li><code>│   ├── main</code></li>\n<li><code>│   │   ├── java</code></li>\n<li><code>│   │   │   └── pool</code></li>\n<li><code>│   │   │       └── server</code></li>\n<li><code>│   │   │           ├── entity</code></li>\n<li><code>│   │   │           │   ├── base #实体类基类（公共属性）</code></li>\n<li><code>│   │   │           │   │   └── PoolRewardEntityjava</code></li>\n<li><code>│   │   │           │   └── PoolIronRewardEntity.java #具体币种实体类（对应真实表名，无属性）</code></li>\n<li><code>│   │   │           ├── mapper</code></li>\n<li><code>│   │   │           │   ├── base #myabtisplus公共mapper；自定义方法中需要包含tableKey</code></li>\n<li><code>│   │   │           │   │   └── PoolRewardMapper.java</code></li>\n<li><code>│   │   │           │   ├── PoolIronRewardMapper.java#真实mapper；无方法，需继承公共mapper</code></li>\n<li><code>│   │   │           │   ├── factory</code></li>\n<li><code>│   │   │           │   │   └── CurrencyMapperFactory.java#币种mapper工厂类，封装不同mapper的调用逻辑</code></li>\n<li><code>│   │   │           ├── service</code></li>\n<li><code>│   │   │           │   ├── base # myabtisplus层公共实现类；</code></li>\n<li><code>│   │   │           │   │   └──  PoolRewardService.java</code></li>\n<li><code>│   │   │           │   │   └── impl</code></li>\n<li><code>│   │   │           │   ├── aleo  #myabtisplus具体币种的实现类；无方法，继承公共方法；</code></li>\n<li><code>│   │   │           │   ├── factory #myabtisplus币种service工厂类，封装不同service的调用逻辑</code></li>\n<li><code>│   │   │           │   ├── business  #业务方法接口及实现类，用于封装公共业务方法；</code></li>\n<li><code>│   │   │           │   │   └── impl</code></li>\n<li><code>│   │   │           │   └── proxy  # 对于复杂的业务做代理层；用于组装业务方法接口；返回前端</code></li>\n</ul>\n<h3 id=\"一-有关币种相关业务抽离重构\"><a class=\"markdownIt-Anchor\" href=\"#一-有关币种相关业务抽离重构\">#</a> 一、有关币种相关业务抽离重构</h3>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2023/08/25/hello-world/",
            "url": "http://example.com/2023/08/25/hello-world/",
            "title": "Hello World",
            "date_published": "2023-08-25T08:20:32.941Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"markdownIt-Anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"markdownIt-Anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"markdownIt-Anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"markdownIt-Anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"markdownIt-Anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": []
        }
    ]
}